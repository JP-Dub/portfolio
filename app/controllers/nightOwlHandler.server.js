//const Users = require('../models/users.js')
const data = [
  {
      "id": "HU3-7hXXgEjSCEza5bEJ8Q",
      "alias": "tequesta-brewing-co-tequesta-3",
      "name": "Tequesta Brewing Co",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/8pySykvEiTlCcav0pe8sZw/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/tequesta-brewing-co-tequesta-3?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 100,
      "categories": [
          {
              "alias": "breweries",
              "title": "Breweries"
          }
      ],
      "rating": 4.5,
      "coordinates": {
          "latitude": 26.95792,
          "longitude": -80.084762
      },
      "transactions": [],
      "price": "$",
      "location": {
          "address1": "287 S US Hwy 1",
          "address2": "",
          "address3": "",
          "city": "Tequesta",
          "zip_code": "33469",
          "country": "US",
          "state": "FL",
          "display_address": [
              "287 S US Hwy 1",
              "Tequesta, FL 33469"
          ]
      },
      "phone": "+15617455000",
      "display_phone": "(561) 745-5000",
      "distance": 4673.510543604435
  },
  {
      "id": "uhny8_rOFcnvGKcFCQSNig",
      "alias": "the-cooper-palm-beach-gardens",
      "name": "The Cooper",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/YyoNjoTVtrJJsMZLG8gQfg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/the-cooper-palm-beach-gardens?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 521,
      "categories": [
          {
              "alias": "tradamerican",
              "title": "American (Traditional)"
          },
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "breakfast_brunch",
              "title": "Breakfast & Brunch"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.83798,
          "longitude": -80.11237
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "4610 Pga Blvd",
          "address2": "Ste 100",
          "address3": null,
          "city": "Palm Beach Gardens",
          "zip_code": "33418",
          "country": "US",
          "state": "FL",
          "display_address": [
              "4610 Pga Blvd",
              "Ste 100",
              "Palm Beach Gardens, FL 33418"
          ]
      },
      "phone": "+15616220032",
      "display_phone": "(561) 622-0032",
      "distance": 9090.93286116451
  },
  {
      "id": "Blvxxtl83eKptLnT5-5Qfw",
      "alias": "twisted-trunk-brewing-palm-beach-gardens",
      "name": "Twisted Trunk Brewing",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/Pbu60Fh7JbasL4TYun9yGg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/twisted-trunk-brewing-palm-beach-gardens?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 110,
      "categories": [
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "breweries",
              "title": "Breweries"
          }
      ],
      "rating": 4.5,
      "coordinates": {
          "latitude": 26.8439311506142,
          "longitude": -80.063956218754
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "2000 Pga Blvd",
          "address2": "Ste 5506",
          "address3": "",
          "city": "Palm Beach Gardens",
          "zip_code": "33408",
          "country": "US",
          "state": "FL",
          "display_address": [
              "2000 Pga Blvd",
              "Ste 5506",
              "Palm Beach Gardens, FL 33408"
          ]
      },
      "phone": "+15616712337",
      "display_phone": "(561) 671-2337",
      "distance": 9248.357420975115
  },
  {
      "id": "x1hQLeWjvdgfAtLcI5BGOQ",
      "alias": "civil-society-brewing-jupiter",
      "name": "Civil Society Brewing",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/HrC6I-2mWeLxy5K7ET2OCQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/civil-society-brewing-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 122,
      "categories": [
          {
              "alias": "breweries",
              "title": "Breweries"
          },
          {
              "alias": "beerbar",
              "title": "Beer Bar"
          }
      ],
      "rating": 4.5,
      "coordinates": {
          "latitude": 26.8895711356722,
          "longitude": -80.1152610036459
      },
      "transactions": [],
      "price": "$",
      "location": {
          "address1": "1200 Town Center Dr",
          "address2": "Unit 101",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33458",
          "country": "US",
          "state": "FL",
          "display_address": [
              "1200 Town Center Dr",
              "Unit 101",
              "Jupiter, FL 33458"
          ]
      },
      "phone": "+15618556680",
      "display_phone": "(561) 855-6680",
      "distance": 3509.9884947317732
  },
  {
      "id": "iP9hahpPrM6shGWRNnDvEg",
      "alias": "calaveras-cantina-jupiter",
      "name": "Calaveras Cantina",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/tUuALsFDajZTdQDC_d8JjA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/calaveras-cantina-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 309,
      "categories": [
          {
              "alias": "mexican",
              "title": "Mexican"
          },
          {
              "alias": "cocktailbars",
              "title": "Cocktail Bars"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.935566,
          "longitude": -80.083175
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "125 Dockside Cir",
          "address2": "",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "125 Dockside Cir",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15613209661",
      "display_phone": "(561) 320-9661",
      "distance": 2698.317898944513
  },
  {
      "id": "KJE74dEETv3GDuDew99y9w",
      "alias": "old-florida-bar-and-grill-jupiter",
      "name": "Old Florida Bar & Grill",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/iH_WUDXQ9lg9knSPbI1HYA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/old-florida-bar-and-grill-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 179,
      "categories": [
          {
              "alias": "seafood",
              "title": "Seafood"
          },
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "tradamerican",
              "title": "American (Traditional)"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.93374,
          "longitude": -80.09701
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "250 W Indiantown Rd",
          "address2": "Ste 101",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33458",
          "country": "US",
          "state": "FL",
          "display_address": [
              "250 W Indiantown Rd",
              "Ste 101",
              "Jupiter, FL 33458"
          ]
      },
      "phone": "+15612032302",
      "display_phone": "(561) 203-2302",
      "distance": 1721.80633742559
  },
  {
      "id": "oc8VbUpvsK1_iPOxBL0mww",
      "alias": "1000-north-jupiter-10",
      "name": "1000 NORTH",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/QBMkE1RJW1JHV4eM3sFADA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/1000-north-jupiter-10?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 154,
      "categories": [
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "newamerican",
              "title": "American (New)"
          },
          {
              "alias": "venues",
              "title": "Venues & Event Spaces"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.945891,
          "longitude": -80.085394
      },
      "transactions": [],
      "price": "$$$$",
      "location": {
          "address1": "1000 N US Hwy 1",
          "address2": "",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "1000 N US Hwy 1",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15615701000",
      "display_phone": "(561) 570-1000",
      "distance": 3452.1794849144035
  },
  {
      "id": "Xzj5r5stAGV5EQxoGQ5laA",
      "alias": "the-parched-pig-palm-beach-gardens",
      "name": "The Parched Pig",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/d5cfavt5xk-x_TNEfGFxIQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/the-parched-pig-palm-beach-gardens?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 59,
      "categories": [
          {
              "alias": "wine_bars",
              "title": "Wine Bars"
          },
          {
              "alias": "seafood",
              "title": "Seafood"
          },
          {
              "alias": "cocktailbars",
              "title": "Cocktail Bars"
          }
      ],
      "rating": 4.5,
      "coordinates": {
          "latitude": 26.8816248207554,
          "longitude": -80.1058243380982
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "4580 Donald Ross Rd",
          "address2": "Ste 100",
          "address3": null,
          "city": "Palm Beach Gardens",
          "zip_code": "33418",
          "country": "US",
          "state": "FL",
          "display_address": [
              "4580 Donald Ross Rd",
              "Ste 100",
              "Palm Beach Gardens, FL 33418"
          ]
      },
      "phone": "+15613603063",
      "display_phone": "(561) 360-3063",
      "distance": 4196.911814498589
  },
  {
      "id": "mP735dFngJT5pb8lZV4DBA",
      "alias": "u-tiki-beach-jupiter",
      "name": "U-Tiki Beach",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/FN5rTYhY1tAU665VT7JKJA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/u-tiki-beach-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 581,
      "categories": [
          {
              "alias": "seafood",
              "title": "Seafood"
          },
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "tradamerican",
              "title": "American (Traditional)"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.945979,
          "longitude": -80.083832
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "1095 N Highway A1a",
          "address2": "",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "1095 N Highway A1a",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15614062210",
      "display_phone": "(561) 406-2210",
      "distance": 3542.8257801799955
  },
  {
      "id": "RR9ktW_FrmhIN2usveXzkw",
      "alias": "tommy-bahama-restaurant-bar-store-jupiter-jupiter",
      "name": "Tommy Bahama Restaurant | Bar | Store - Jupiter",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/6RD0Z0-9xtKxj_mkyV-CyA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/tommy-bahama-restaurant-bar-store-jupiter-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 254,
      "categories": [
          {
              "alias": "cocktailbars",
              "title": "Cocktail Bars"
          },
          {
              "alias": "seafood",
              "title": "Seafood"
          },
          {
              "alias": "newamerican",
              "title": "American (New)"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.936132,
          "longitude": -80.083179
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "126 Soundings Ave.",
          "address2": "",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "126 Soundings Ave.",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15614066631",
      "display_phone": "(561) 406-6631",
      "distance": 2740.594783713372
  },
  {
      "id": "a-kFS8BZ8Mku0HnkekQ7cw",
      "alias": "papichulo-tacos-tequesta",
      "name": "PapiChulo Tacos",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/0Icyc8_iwBYFY5vWbhqmJQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/papichulo-tacos-tequesta?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 188,
      "categories": [
          {
              "alias": "tacos",
              "title": "Tacos"
          },
          {
              "alias": "cocktailbars",
              "title": "Cocktail Bars"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.95414,
          "longitude": -80.08559
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "1556 US-1",
          "address2": "",
          "address3": null,
          "city": "Tequesta",
          "zip_code": "33469",
          "country": "US",
          "state": "FL",
          "display_address": [
              "1556 US-1",
              "Tequesta, FL 33469"
          ]
      },
      "phone": "+15612507274",
      "display_phone": "(561) 250-7274",
      "distance": 4257.3063588972855
  },
  {
      "id": "mkyY0e45DM8piY_JCll8JQ",
      "alias": "aarons-table-and-wine-bar-jupiter-2",
      "name": "Aaron's Table and Wine Bar",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/3jc4i1pY9B5G8U7IPv5RHQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/aarons-table-and-wine-bar-jupiter-2?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 169,
      "categories": [
          {
              "alias": "newamerican",
              "title": "American (New)"
          },
          {
              "alias": "wine_bars",
              "title": "Wine Bars"
          },
          {
              "alias": "cocktailbars",
              "title": "Cocktail Bars"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.88983,
          "longitude": -80.11435
      },
      "transactions": [
          "pickup"
      ],
      "price": "$$",
      "location": {
          "address1": "1153 Town Center Dr",
          "address2": "Ste 101",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33458",
          "country": "US",
          "state": "FL",
          "display_address": [
              "1153 Town Center Dr",
              "Ste 101",
              "Jupiter, FL 33458"
          ]
      },
      "phone": "+15618552628",
      "display_phone": "(561) 855-2628",
      "distance": 3445.7460643889085
  },
  {
      "id": "eMSKP3KduLHIHltimfLEhA",
      "alias": "blue-pointe-bar-and-grill-tequesta",
      "name": "Blue Pointe Bar and Grill",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/2fThlb2Z6SClT8zjakt_9w/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/blue-pointe-bar-and-grill-tequesta?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 60,
      "categories": [
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "tradamerican",
              "title": "American (Traditional)"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.9768395974816,
          "longitude": -80.0866121592468
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "18701 SE Federal Hwy",
          "address2": null,
          "address3": "",
          "city": "Tequesta",
          "zip_code": "33469",
          "country": "US",
          "state": "FL",
          "display_address": [
              "18701 SE Federal Hwy",
              "Tequesta, FL 33469"
          ]
      },
      "phone": "+15614066270",
      "display_phone": "(561) 406-6270",
      "distance": 6609.820801767173
  },
  {
      "id": "tkXIEqf-RbRMcQdxTlOVng",
      "alias": "square-grouper-tiki-bar-jupiter",
      "name": "Square Grouper Tiki Bar",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/JGgLiaQQTVEpHYAsuHZ4Wg/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/square-grouper-tiki-bar-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 418,
      "categories": [
          {
              "alias": "tikibars",
              "title": "Tiki Bars"
          },
          {
              "alias": "sandwiches",
              "title": "Sandwiches"
          },
          {
              "alias": "cocktailbars",
              "title": "Cocktail Bars"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.9455839207322,
          "longitude": -80.081413314177
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "1111 Love St",
          "address2": "",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "1111 Love St",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15614066417",
      "display_phone": "(561) 406-6417",
      "distance": 3644.1311928459677
  },
  {
      "id": "8PofVgI-0SSTBoy8QxaWYg",
      "alias": "2-vinez-jupiter-7",
      "name": "2 Vinez",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/8m7OgvITxgYQvIkV-v92OQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/2-vinez-jupiter-7?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 84,
      "categories": [
          {
              "alias": "asianfusion",
              "title": "Asian Fusion"
          },
          {
              "alias": "sushi",
              "title": "Sushi Bars"
          },
          {
              "alias": "wine_bars",
              "title": "Wine Bars"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.935097,
          "longitude": -80.088474
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "287 E Indiantown Rd",
          "address2": "Ste 2B",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "287 E Indiantown Rd",
              "Ste 2B",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15617456262",
      "display_phone": "(561) 745-6262",
      "distance": 2294.908388542513
  },
  {
      "id": "9JxYob7fJFVy9e6W8YBR-w",
      "alias": "guanabanas-jupiter",
      "name": "Guanabanas",
      "image_url": "https://s3-media1.fl.yelpcdn.com/bphoto/MpZICT9FTAmMEowvR0y7Fw/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/guanabanas-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 1211,
      "categories": [
          {
              "alias": "seafood",
              "title": "Seafood"
          },
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "musicvenues",
              "title": "Music Venues"
          }
      ],
      "rating": 3.5,
      "coordinates": {
          "latitude": 26.9425554088205,
          "longitude": -80.0811966009517
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "960 N Hwy A1A",
          "address2": "",
          "address3": "",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "960 N Hwy A1A",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15617478878",
      "display_phone": "(561) 747-8878",
      "distance": 3394.000407511128
  },
  {
      "id": "NxltEAGeibvj-jQSAkySew",
      "alias": "lynoras-jupiter",
      "name": "Lynora's",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/ddaVDrnTKCo3lzXWUrfrTA/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/lynoras-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 150,
      "categories": [
          {
              "alias": "italian",
              "title": "Italian"
          },
          {
              "alias": "bars",
              "title": "Bars"
          },
          {
              "alias": "pizza",
              "title": "Pizza"
          }
      ],
      "rating": 4,
      "coordinates": {
          "latitude": 26.95363,
          "longitude": -80.085723
      },
      "transactions": [
          "restaurant_reservation"
      ],
      "price": "$$",
      "location": {
          "address1": "1548 US 1",
          "address2": "",
          "address3": null,
          "city": "Jupiter",
          "zip_code": "33469",
          "country": "US",
          "state": "FL",
          "display_address": [
              "1548 US 1",
              "Jupiter, FL 33469"
          ]
      },
      "phone": "+15612032702",
      "display_phone": "(561) 203-2702",
      "distance": 4198.857528358623
  },
  {
      "id": "FhtO4WsXlwynLr-9-m4c8w",
      "alias": "the-vine-post-juno-beach",
      "name": "The Vine Post",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/SIyXgenPEPuI8G_T19Bc2Q/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/the-vine-post-juno-beach?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 10,
      "categories": [
          {
              "alias": "beer_and_wine",
              "title": "Beer, Wine & Spirits"
          },
          {
              "alias": "wine_bars",
              "title": "Wine Bars"
          },
          {
              "alias": "winetasteclasses",
              "title": "Wine Tasting Classes"
          }
      ],
      "rating": 5,
      "coordinates": {
          "latitude": 26.882048,
          "longitude": -80.058747
      },
      "transactions": [],
      "price": "$$",
      "location": {
          "address1": "817 Donald Ross Rd",
          "address2": null,
          "address3": "",
          "city": "Juno Beach",
          "zip_code": "33408",
          "country": "US",
          "state": "FL",
          "display_address": [
              "817 Donald Ross Rd",
              "Juno Beach, FL 33408"
          ]
      },
      "phone": "+15619351720",
      "display_phone": "(561) 935-1720",
      "distance": 6060.221607681415
  },
  {
      "id": "gALtqb2EO_TXu1YGXj6J_Q",
      "alias": "the-doghouse-grille-jupiter",
      "name": "The Doghouse Grille",
      "image_url": "https://s3-media2.fl.yelpcdn.com/bphoto/7Sday9mAdSixiCr8cLZnQQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/the-doghouse-grille-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 27,
      "categories": [
          {
              "alias": "hotdog",
              "title": "Hot Dogs"
          },
          {
              "alias": "pubs",
              "title": "Pubs"
          },
          {
              "alias": "sandwiches",
              "title": "Sandwiches"
          }
      ],
      "rating": 4.5,
      "coordinates": {
          "latitude": 26.8842542542799,
          "longitude": -80.1049607992172
      },
      "transactions": [
          "delivery"
      ],
      "price": "$$",
      "location": {
          "address1": "5430 Military Trl",
          "address2": "Ste 70",
          "address3": null,
          "city": "Jupiter",
          "zip_code": "33458",
          "country": "US",
          "state": "FL",
          "display_address": [
              "5430 Military Trl",
              "Ste 70",
              "Jupiter, FL 33458"
          ]
      },
      "phone": "+15616199680",
      "display_phone": "(561) 619-9680",
      "distance": 3900.6752373680947
  },
  {
      "id": "hvCWpvuCh0FO5rkEG6RdZA",
      "alias": "the-woods-jupiter-jupiter",
      "name": "The Woods Jupiter",
      "image_url": "https://s3-media3.fl.yelpcdn.com/bphoto/hSQThr8P33JXfTzTb8QqRQ/o.jpg",
      "is_closed": false,
      "url": "https://www.yelp.com/biz/the-woods-jupiter-jupiter?adjust_creative=RdWj-yTflu7GcvUrdnUfWQ&utm_campaign=yelp_api_v3&utm_medium=api_v3_business_search&utm_source=RdWj-yTflu7GcvUrdnUfWQ",
      "review_count": 442,
      "categories": [
          {
              "alias": "newamerican",
              "title": "American (New)"
          },
          {
              "alias": "sportsbars",
              "title": "Sports Bars"
          },
          {
              "alias": "desserts",
              "title": "Desserts"
          }
      ],
      "rating": 3.5,
      "coordinates": {
          "latitude": 26.9360737,
          "longitude": -80.0828192
      },
      "transactions": [],
      "price": "$$$",
      "location": {
          "address1": "129 Soundings Ave",
          "address2": "",
          "address3": "Harbourside Pl",
          "city": "Jupiter",
          "zip_code": "33477",
          "country": "US",
          "state": "FL",
          "display_address": [
              "129 Soundings Ave",
              "Harbourside Pl",
              "Jupiter, FL 33477"
          ]
      },
      "phone": "+15613209627",
      "display_phone": "(561) 320-9627",
      "distance": 2774.1634387871336
  }
]

function NightOwlHandler() {
  // resets RSVP's after 6am;
  this.resetRSVP = (req, res) => {
    if(new Date().getHours() === 6) {
      Users.updateMany({},
        { $pull: 
          {'twitter.nightlife': {} }
        })
        .exec(err => {
          if (err) throw err;           
      }); 
      
    }
    return res.status(200).end();
  };
  
  // return all rsvps for users
	this.getClicks = (req, res) => {
    return res.json([{}])
    let nightlife = [];
    // check if id exists in nightlife array
    function findId(id) {
      for(let i = 0; i < nightlife.length; i++) {
        if(nightlife[i].id === id) return i;
      }   
      return false;
    };  
	
    Users
		  .find({}).select({ 'twitter.nightlife': 1})
			.exec((err, results) => {
				if (err) throw err;
        
        // return restaurant id and total 'going' count for all users
        results.forEach((array, idx) => {
          let arr = array.twitter.nightlife;
        
          if(arr.length) {
            for(let i = 0; i < arr.length; i++) {           
              let item = arr[i];
              if(item.count) {
                let index = nightlife.length ? findId(item.id) : false;
                if(index !== false) {
                   nightlife[index].count += item.count;
                } else {
                   nightlife.push({
                     'id'    : item.id,
                     'count' : item.count
                   }); 
                }
              }
            }
          }
        });

		res.json(nightlife);
		}); 
  }; // getClicks

  // for authenticated users to add or remove rsvp  
	this.addClick = (req, res) => {
		Users
			.findOne({'twitter.id': req.body.userId})
      .select({'twitter.nightlife': 1})
			.exec((err, result) => {
					if (err) throw err;      
      
          if(result) {
            let nightlife = result.twitter.nightlife,
                barCount = {},
                barExists = false;
            for(var i = 0; i < nightlife.length; i++) {
                     
               if(nightlife[i].id === req.body.id ) {
                 nightlife[i].count = nightlife[i].count === 1 ? 0 : 1;
                 barCount.id        = nightlife[i].id;                
                 barCount.count     = nightlife[i].count === 0 ? -1 : 1;
                 barExists          = true;
               }
            };                      
            
            if(!barExists) {
              let obj = { 
                id    : req.body.id,
                name  : req.body.name,
                count : 1
              };
              
              // return obj to db and send barCount to UI
              result.twitter.nightlife.push(obj); 
              barCount = { 
                id    : req.body.id, 
                count : 1
              };
            }
            
            result.save( err => {
              if(err) throw err;
              res.json(barCount);
            });            
         };
			});
	};
	
	// queries the Yelp api and stores session data and location
	this.getNightlife = (req, res) => {
    let json = JSON.stringify(data)
    return res.json(json)

		 let Client = yelp.client(process.env.API_KEY),
         request = {
        		term    : 'bars',
    	    	location: req.query.location,
            sort_by : 'rating',
            limit   : 20,
        	};
     
     //if user authenticates, save location to user
     if(req.body.user) { 
       Users.findOneAndUpdate({ 
            'twitter.id' : req.body.user
            }, {
            'twitter.previousSession' : req.query.location
            }, {
            new   : true, 
            upsert: true
            })
          	.exec((err, success) => {
             	if(err) return console.error(err);
        	  });    
     };
      
      // Yelp Fusion api	
     Client.search(request).then(response => {
       var results = response.jsonBody.businesses,
           json    = JSON.stringify(results, null, 4);
           
           res.json(json);
     }).catch(error => {
       	  res.status(400).json(error);
    }); 
	};
	
	// returns the user location and cached search results after twitter log in
	this.userLocation = (req, res) => {
    if(!req.user) return res.json({error: 'The User is not signed in'});
		
    Users.find({_id: req.user._id})
			.exec((err, user) => {
				if(err) throw err;       
       
        return res.json(user[0]);     				
			});
	}; 
 

};

module.exports = NightOwlHandler;